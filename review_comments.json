[{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807802721","pull_request_review_id":3802338304,"id":2807802721,"node_id":"PRRC_kwDORP6kLM6nW6th","diff_hunk":"@@ -0,0 +1,80 @@\n+import type { Card } from './schema';\n+\n+/**\n+ * Merges a local card with a remote card based on the \"offline-first\" sync strategy.\n+ *\n+ * Strategy:\n+ * - If local field is CLEAN (not in dirtyFields), accept REMOTE change.\n+ * - If local field is DIRTY (in dirtyFields), keep LOCAL change.\n+ * - If both LOCAL and REMOTE changed the same field (relative to snapshot), mark as CONFLICT.\n+ */\n+export function mergeCards(local: Card, remote: Card): Card {\n+  // Optimization: If local has no changes, we can safely overwrite with remote.\n+  if (!local.dirtyFields || local.dirtyFields.length === 0) {\n+    return remote;\n+  }\n+\n+  // We need the snapshot to determine if the remote value has changed since the last sync.\n+  const snapshot = local.syncSnapshot as Partial<Card> | undefined;\n+\n+  const result = { ...local };\n+\n+  // Fields that are synchronized and subject to merge logic.\n+  const mutableFields = [\n+    'title',\n+    'description',\n+    'status',\n+    'priority',\n+    'labels',\n+    'assignees',\n+    'position',\n+  ] as const;\n+\n+  let hasConflict = false;\n+\n+  for (const field of mutableFields) {\n+    const remoteValue = remote[field];\n+    const snapshotValue = snapshot ? snapshot[field] : undefined;\n+\n+    const isDirty = local.dirtyFields?.includes(field);\n+\n+    // Remote changed if it differs from the snapshot we took last time.\n+    // If we have no snapshot, we assume remote is different (safe default).\n+    const remoteChanged = !isEqual(remoteValue, snapshotValue);","path":"packages/core/src/merge.ts","commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","original_commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","user":{"login":"devin-ai-integration[bot]","id":158243242,"node_id":"BOT_kgDOCW6Zqg","avatar_url":"https://avatars.githubusercontent.com/in/811515?v=4","gravatar_id":"","url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D","html_url":"https://github.com/apps/devin-ai-integration","followers_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/followers","following_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/repos","events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"<!-- devin-review-comment {\"id\": \"BUG_pr-review-job-aaae65a1e6174a53869689ed6d599df8_0001\", \"file_path\": \"packages/core/src/merge.ts\", \"start_line\": 42, \"end_line\": 43, \"side\": \"RIGHT\"} -->\n\nüî¥ **False conflicts when `dirtyFields` is present but `syncSnapshot` is missing**\n\nWhen a card has `dirtyFields` populated but no `syncSnapshot`, the merge algorithm incorrectly marks every dirty field as conflicting.\n\n<details>\n<summary>Root Cause</summary>\n\nAt `packages/core/src/merge.ts:37`, when `snapshot` is `undefined`, `snapshotValue` is always `undefined`. At line 43, `remoteChanged = !isEqual(remoteValue, undefined)` evaluates to `true` for any non-undefined remote value (which is the case for required fields like `title`, `status`, `priority`, etc.).\n\nThis means for every field in `mutableFields` that is dirty, the code enters the `isDirty && remoteChanged` branch at line 49, setting `hasConflict = true` ‚Äî even though there's no evidence the remote actually changed.\n\nFor example, if a card has `dirtyFields: ['title']` but no `syncSnapshot`:\n```\nsnapshotValue = undefined  // no snapshot\nremoteValue = 'Some Title' // any non-undefined value\nremoteChanged = !isEqual('Some Title', undefined) // true\nisDirty = true\n// ‚Üí hits isDirty && remoteChanged ‚Üí false conflict!\n```\n\nThis violates the documented strategy: \"If both LOCAL and REMOTE changed the same field (relative to snapshot), mark as CONFLICT.\" Without a snapshot, the algorithm cannot determine if remote changed, yet it still marks conflicts.\n\n**Impact:** Any card that has local modifications but lacks a sync snapshot (e.g., a newly created local card, or a card whose snapshot was cleared) will always be falsely marked as `conflict` when merged with a remote version, making the merge result unreliable.\n\n</details>\n\n<details>\n<summary>Prompt for agents</summary>\n\n```\nIn packages/core/src/merge.ts, the merge algorithm needs to handle the case where syncSnapshot is missing but dirtyFields is present. When there is no snapshot, the algorithm cannot determine whether the remote value has changed, so it should NOT mark fields as conflicting. One approach is to treat remoteChanged as false when there is no snapshot (i.e., assume remote hasn't changed), which preserves local changes without false conflicts. Change line 43 from:\n\nconst remoteChanged = !isEqual(remoteValue, snapshotValue);\n\nto something like:\n\nconst remoteChanged = snapshot !== undefined && !isEqual(remoteValue, snapshotValue);\n\nThis ensures that without a snapshot, dirty fields are preserved (local wins) and no false conflicts are generated. Also add a test case for this scenario: a card with dirtyFields but no syncSnapshot merged against a remote card should keep local values without marking conflict.\n```\n\n</details>\n\n<!-- devin-review-badge-begin -->\n<a href=\"https://app.devin.ai/review/lofi-monk/github-project-management/pull/5\" target=\"_blank\">\n  <picture>\n    <source media=\"(prefers-color-scheme: dark)\" srcset=\"https://static.devin.ai/assets/gh-open-in-devin-review-dark.svg?v=1\">\n    <img src=\"https://static.devin.ai/assets/gh-open-in-devin-review-light.svg?v=1\" alt=\"Open in Devin Review\">\n  </picture>\n</a>\n<!-- devin-review-badge-end -->\n\n---\n*Was this helpful? React with üëç or üëé to provide feedback.*","created_at":"2026-02-14T18:59:45Z","updated_at":"2026-02-14T18:59:46Z","html_url":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807802721","pull_request_url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5","_links":{"self":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807802721"},"html":{"href":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807802721"},"pull_request":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5"}},"reactions":{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807802721/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":42,"original_start_line":42,"start_side":"RIGHT","line":43,"original_line":43,"side":"RIGHT","author_association":"NONE","original_position":43,"position":43,"subject_type":"line"},{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807806871","pull_request_review_id":3802342791,"id":2807806871,"node_id":"PRRC_kwDORP6kLM6nW7uX","diff_hunk":"@@ -0,0 +1,80 @@\n+import type { Card } from './schema';\n+\n+/**\n+ * Merges a local card with a remote card based on the \"offline-first\" sync strategy.\n+ *\n+ * Strategy:\n+ * - If local field is CLEAN (not in dirtyFields), accept REMOTE change.\n+ * - If local field is DIRTY (in dirtyFields), keep LOCAL change.\n+ * - If both LOCAL and REMOTE changed the same field (relative to snapshot), mark as CONFLICT.\n+ */\n+export function mergeCards(local: Card, remote: Card): Card {\n+  // Optimization: If local has no changes, we can safely overwrite with remote.\n+  if (!local.dirtyFields || local.dirtyFields.length === 0) {\n+    return remote;\n+  }\n+\n+  // We need the snapshot to determine if the remote value has changed since the last sync.\n+  const snapshot = local.syncSnapshot as Partial<Card> | undefined;\n+\n+  const result = { ...local };\n+\n+  // Fields that are synchronized and subject to merge logic.\n+  const mutableFields = [\n+    'title',\n+    'description',\n+    'status',\n+    'priority',\n+    'labels',\n+    'assignees',\n+    'position',\n+  ] as const;\n+\n+  let hasConflict = false;\n+\n+  for (const field of mutableFields) {\n+    const remoteValue = remote[field];\n+    const snapshotValue = snapshot ? snapshot[field] : undefined;\n+\n+    const isDirty = local.dirtyFields?.includes(field);\n+\n+    // Remote changed if it differs from the snapshot we took last time.\n+    // If we have no snapshot, we assume remote is different (safe default).\n+    const remoteChanged = !isEqual(remoteValue, snapshotValue);\n+\n+    if (!isDirty && remoteChanged) {\n+      // CASE: Local is clean, Remote changed.\n+      // Action: Accept GitHub value (Automation or other user).\n+      (result as any)[field] = remoteValue;\n+    } else if (isDirty && remoteChanged) {\n+      // CASE: Local is dirty, Remote changed.\n+      // Action: Conflict. We keep the local value to preserve user work,\n+      // but mark the card as conflicting so the UI can flag it.\n+      hasConflict = true;\n+    }\n+    // CASE: !isDirty && !remoteChanged -> Both same, keep local (which matches remote).\n+    // CASE: isDirty && !remoteChanged  -> Local changed, Remote same. Keep local (pending push).\n+  }\n+\n+  if (hasConflict) {\n+    result.syncStatus = 'conflict';\n+  }\n+\n+  return result;\n+}\n+\n+/**\n+ * Helper to compare field values.\n+ * specific handling for arrays (labels, assignees) to ensure content equality.\n+ */\n+function isEqual(a: any, b: any): boolean {\n+  if (a === b) return true;\n+  if (Array.isArray(a) && Array.isArray(b)) {\n+    if (a.length !== b.length) return false;\n+    for (let i = 0; i < a.length; i++) {\n+      if (a[i] !== b[i]) return false;\n+    }\n+    return true;\n+  }\n+  return false;","path":"packages/core/src/merge.ts","commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","original_commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","user":{"login":"devin-ai-integration[bot]","id":158243242,"node_id":"BOT_kgDOCW6Zqg","avatar_url":"https://avatars.githubusercontent.com/in/811515?v=4","gravatar_id":"","url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D","html_url":"https://github.com/apps/devin-ai-integration","followers_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/followers","following_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/repos","events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"<!-- devin-review-comment {\"id\": \"BUG-0001\", \"file_path\": \"packages/core/src/merge.ts\", \"start_line\": 70, \"end_line\": 79, \"side\": \"RIGHT\"} -->\n\nüü° **`isEqual` treats `null`/`undefined` comparisons as not-equal, causing false \"remote changed\" detection**\n\nThe `isEqual` helper at `packages/core/src/merge.ts:70-79` uses strict equality (`===`) as its base case and returns `false` for any non-array, non-strictly-equal pair. This means `isEqual(undefined, null)` returns `false`, and more importantly, `isEqual(undefined, undefined)` returns `true` BUT `isEqual(null, undefined)` returns `false`.\n\nWhile this works for the current field set, the `description` field is `optional()` in the Zod schema, meaning it can be `undefined`. If the snapshot stores `description` as `null` (e.g., from a JSON round-trip where `undefined` becomes `null`), then `isEqual(undefined, null)` would return `false`, incorrectly detecting a remote change when nothing actually changed.\n\n<details>\n<summary>Root Cause and Impact</summary>\n\nJSON serialization converts `undefined` to `null` (or omits the key). If `syncSnapshot` is ever serialized to JSON and deserialized (e.g., stored in SQLite/localStorage), optional fields that were `undefined` will become `null` or be missing entirely. When the merge algorithm later compares `remote.description` (`undefined`) against `snapshot.description` (`null` from JSON), `isEqual` returns `false`, causing the algorithm to incorrectly treat the field as \"remote changed.\"\n\nThis leads to:\n- Clean local fields being unnecessarily overwritten with the remote value (benign in the non-dirty case)\n- Dirty local fields being falsely flagged as conflicts when the remote hasn't actually changed\n\nFor example:\n```js\n// After JSON round-trip of snapshot\nconst snapshot = JSON.parse(JSON.stringify({ description: undefined }));\n// snapshot is now {} ‚Äî description key is missing\n// snapshot.description is undefined ‚Äî this case is fine\n\n// But if stored as null explicitly:\nconst snapshot2 = { description: null };\nisEqual(undefined, null); // false ‚Äî false positive \"remote changed\"\n```\n\n</details>\n\n<!-- devin-review-badge-begin -->\n<a href=\"https://app.devin.ai/review/LoFi-Monk/github-project-management/pull/5\" target=\"_blank\">\n  <picture>\n    <source media=\"(prefers-color-scheme: dark)\" srcset=\"https://static.devin.ai/assets/gh-open-in-devin-review-dark.svg?v=1\">\n    <img src=\"https://static.devin.ai/assets/gh-open-in-devin-review-light.svg?v=1\" alt=\"Open in Devin Review\">\n  </picture>\n</a>\n<!-- devin-review-badge-end -->\n\n---\n*Was this helpful? React with üëç or üëé to provide feedback.*","created_at":"2026-02-14T19:05:32Z","updated_at":"2026-02-14T19:05:33Z","html_url":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807806871","pull_request_url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5","_links":{"self":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807806871"},"html":{"href":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807806871"},"pull_request":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5"}},"reactions":{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807806871/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":70,"original_start_line":70,"start_side":"RIGHT","line":79,"original_line":79,"side":"RIGHT","author_association":"NONE","original_position":79,"position":79,"subject_type":"line"},{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808221","pull_request_review_id":3802344896,"id":2807808221,"node_id":"PRRC_kwDORP6kLM6nW8Dd","diff_hunk":"@@ -0,0 +1,80 @@\n+import type { Card } from './schema';\n+\n+/**\n+ * Merges a local card with a remote card based on the \"offline-first\" sync strategy.\n+ *\n+ * Strategy:\n+ * - If local field is CLEAN (not in dirtyFields), accept REMOTE change.\n+ * - If local field is DIRTY (in dirtyFields), keep LOCAL change.\n+ * - If both LOCAL and REMOTE changed the same field (relative to snapshot), mark as CONFLICT.\n+ */\n+export function mergeCards(local: Card, remote: Card): Card {\n+  // Optimization: If local has no changes, we can safely overwrite with remote.\n+  if (!local.dirtyFields || local.dirtyFields.length === 0) {\n+    return remote;\n+  }\n+\n+  // We need the snapshot to determine if the remote value has changed since the last sync.\n+  const snapshot = local.syncSnapshot as Partial<Card> | undefined;\n+\n+  const result = { ...local };\n+\n+  // Fields that are synchronized and subject to merge logic.\n+  const mutableFields = [\n+    'title',\n+    'description',\n+    'status',\n+    'priority',\n+    'labels',\n+    'assignees',\n+    'position',\n+  ] as const;\n+\n+  let hasConflict = false;\n+\n+  for (const field of mutableFields) {\n+    const remoteValue = remote[field];\n+    const snapshotValue = snapshot ? snapshot[field] : undefined;\n+\n+    const isDirty = local.dirtyFields?.includes(field);\n+\n+    // Remote changed if it differs from the snapshot we took last time.\n+    // If we have no snapshot, we assume remote is different (safe default).\n+    const remoteChanged = !isEqual(remoteValue, snapshotValue);\n+\n+    if (!isDirty && remoteChanged) {\n+      // CASE: Local is clean, Remote changed.\n+      // Action: Accept GitHub value (Automation or other user).\n+      (result as any)[field] = remoteValue;\n+    } else if (isDirty && remoteChanged) {\n+      // CASE: Local is dirty, Remote changed.\n+      // Action: Conflict. We keep the local value to preserve user work,\n+      // but mark the card as conflicting so the UI can flag it.\n+      hasConflict = true;\n+    }\n+    // CASE: !isDirty && !remoteChanged -> Both same, keep local (which matches remote).\n+    // CASE: isDirty && !remoteChanged  -> Local changed, Remote same. Keep local (pending push).\n+  }\n+\n+  if (hasConflict) {\n+    result.syncStatus = 'conflict';\n+  }\n+\n+  return result;","path":"packages/core/src/merge.ts","commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","original_commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","user":{"login":"devin-ai-integration[bot]","id":158243242,"node_id":"BOT_kgDOCW6Zqg","avatar_url":"https://avatars.githubusercontent.com/in/811515?v=4","gravatar_id":"","url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D","html_url":"https://github.com/apps/devin-ai-integration","followers_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/followers","following_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/repos","events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"<!-- devin-review-comment {\"id\": \"ANALYSIS-0001\", \"file_path\": \"packages/core/src/merge.ts\", \"start_line\": 20, \"end_line\": 63, \"side\": \"RIGHT\"} -->\n\nüö© **Merged result retains stale `dirtyFields` and `syncSnapshot` after accepting remote changes**\n\nAfter the field-level merge loop, the returned `result` card still carries the original `local.dirtyFields` and `local.syncSnapshot`. This means fields that were cleanly resolved from remote are not reflected in the snapshot, and `dirtyFields` still lists fields even if they were overwritten by remote values (in the `!isDirty && remoteChanged` branch for other fields). The caller must know to reset these sync metadata fields after calling `mergeCards`, but nothing in the API contract or JSDoc communicates this. If a future caller uses the merged result directly without updating these fields, subsequent merges could produce incorrect conflict detection because the snapshot is stale.\n\n<!-- devin-review-badge-begin -->\n<a href=\"https://app.devin.ai/review/LoFi-Monk/github-project-management/pull/5\" target=\"_blank\">\n  <picture>\n    <source media=\"(prefers-color-scheme: dark)\" srcset=\"https://static.devin.ai/assets/gh-open-in-devin-review-dark.svg?v=1\">\n    <img src=\"https://static.devin.ai/assets/gh-open-in-devin-review-light.svg?v=1\" alt=\"Open in Devin Review\">\n  </picture>\n</a>\n<!-- devin-review-badge-end -->\n\n---\n*Was this helpful? React with üëç or üëé to provide feedback.*","created_at":"2026-02-14T19:06:49Z","updated_at":"2026-02-14T19:06:50Z","html_url":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807808221","pull_request_url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5","_links":{"self":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808221"},"html":{"href":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807808221"},"pull_request":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5"}},"reactions":{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808221/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":20,"original_start_line":20,"start_side":"RIGHT","line":63,"original_line":63,"side":"RIGHT","author_association":"NONE","original_position":63,"position":63,"subject_type":"line"},{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808362","pull_request_review_id":3802344987,"id":2807808362,"node_id":"PRRC_kwDORP6kLM6nW8Fq","diff_hunk":"@@ -0,0 +1,80 @@\n+import type { Card } from './schema';\n+\n+/**\n+ * Merges a local card with a remote card based on the \"offline-first\" sync strategy.\n+ *\n+ * Strategy:\n+ * - If local field is CLEAN (not in dirtyFields), accept REMOTE change.\n+ * - If local field is DIRTY (in dirtyFields), keep LOCAL change.\n+ * - If both LOCAL and REMOTE changed the same field (relative to snapshot), mark as CONFLICT.\n+ */\n+export function mergeCards(local: Card, remote: Card): Card {\n+  // Optimization: If local has no changes, we can safely overwrite with remote.\n+  if (!local.dirtyFields || local.dirtyFields.length === 0) {\n+    return remote;\n+  }\n+\n+  // We need the snapshot to determine if the remote value has changed since the last sync.\n+  const snapshot = local.syncSnapshot as Partial<Card> | undefined;\n+\n+  const result = { ...local };\n+\n+  // Fields that are synchronized and subject to merge logic.\n+  const mutableFields = [\n+    'title',\n+    'description',\n+    'status',\n+    'priority',\n+    'labels',\n+    'assignees',\n+    'position',\n+  ] as const;","path":"packages/core/src/merge.ts","commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","original_commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","user":{"login":"devin-ai-integration[bot]","id":158243242,"node_id":"BOT_kgDOCW6Zqg","avatar_url":"https://avatars.githubusercontent.com/in/811515?v=4","gravatar_id":"","url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D","html_url":"https://github.com/apps/devin-ai-integration","followers_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/followers","following_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/repos","events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"<!-- devin-review-comment {\"id\": \"ANALYSIS-0002\", \"file_path\": \"packages/core/src/merge.ts\", \"start_line\": 23, \"end_line\": 31, \"side\": \"RIGHT\"} -->\n\nüö© **`updatedAt` is excluded from `mutableFields`, so it's never propagated from remote during field-level merge**\n\nThe `mutableFields` list at lines 23-31 deliberately omits `updatedAt` (and `createdAt`, `id`). When local has dirty fields and we enter the merge loop, `result = { ...local }` preserves the local `updatedAt`. Even when remote field changes are accepted into the result, the timestamp remains the local card's timestamp. This contrasts with the early-return path (line 14) where `return remote` naturally includes the remote's `updatedAt`. This asymmetry means the merged card's `updatedAt` may not reflect the most recent modification. Whether this is a bug depends on whether `updatedAt` is meant to represent \"last modified time of any field\" or is managed separately by the persistence layer.\n\n<!-- devin-review-badge-begin -->\n<a href=\"https://app.devin.ai/review/LoFi-Monk/github-project-management/pull/5\" target=\"_blank\">\n  <picture>\n    <source media=\"(prefers-color-scheme: dark)\" srcset=\"https://static.devin.ai/assets/gh-open-in-devin-review-dark.svg?v=1\">\n    <img src=\"https://static.devin.ai/assets/gh-open-in-devin-review-light.svg?v=1\" alt=\"Open in Devin Review\">\n  </picture>\n</a>\n<!-- devin-review-badge-end -->\n\n---\n*Was this helpful? React with üëç or üëé to provide feedback.*","created_at":"2026-02-14T19:06:58Z","updated_at":"2026-02-14T19:07:00Z","html_url":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807808362","pull_request_url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5","_links":{"self":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808362"},"html":{"href":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807808362"},"pull_request":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5"}},"reactions":{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":23,"original_start_line":23,"start_side":"RIGHT","line":31,"original_line":31,"side":"RIGHT","author_association":"NONE","original_position":31,"position":31,"subject_type":"line"},{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808584","pull_request_review_id":3802345397,"id":2807808584,"node_id":"PRRC_kwDORP6kLM6nW8JI","diff_hunk":"@@ -0,0 +1,80 @@\n+import type { Card } from './schema';\n+\n+/**\n+ * Merges a local card with a remote card based on the \"offline-first\" sync strategy.\n+ *\n+ * Strategy:\n+ * - If local field is CLEAN (not in dirtyFields), accept REMOTE change.\n+ * - If local field is DIRTY (in dirtyFields), keep LOCAL change.\n+ * - If both LOCAL and REMOTE changed the same field (relative to snapshot), mark as CONFLICT.\n+ */\n+export function mergeCards(local: Card, remote: Card): Card {\n+  // Optimization: If local has no changes, we can safely overwrite with remote.\n+  if (!local.dirtyFields || local.dirtyFields.length === 0) {\n+    return remote;\n+  }","path":"packages/core/src/merge.ts","commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","original_commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","user":{"login":"devin-ai-integration[bot]","id":158243242,"node_id":"BOT_kgDOCW6Zqg","avatar_url":"https://avatars.githubusercontent.com/in/811515?v=4","gravatar_id":"","url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D","html_url":"https://github.com/apps/devin-ai-integration","followers_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/followers","following_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/repos","events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"<!-- devin-review-comment {\"id\": \"ANALYSIS-0006\", \"file_path\": \"packages/core/src/merge.ts\", \"start_line\": 12, \"end_line\": 15, \"side\": \"RIGHT\"} -->\n\nüìù **Info: Early return path (`return remote`) discards all local sync metadata**\n\nWhen `local.dirtyFields` is empty or undefined (line 13-14), the function returns `remote` directly. This means any local-only metadata ‚Äî such as `syncStatus`, `syncSnapshot`, or even a `dirtyFields: []` marker ‚Äî is replaced with whatever the remote card has (which likely has no sync metadata at all, since it comes from GitHub). This is probably intentional (clean local = fully accept remote), but it's worth noting that this path and the field-level merge path treat sync metadata very differently. The field-level path preserves local sync metadata; the early-return path discards it entirely.\n\n<!-- devin-review-badge-begin -->\n<a href=\"https://app.devin.ai/review/LoFi-Monk/github-project-management/pull/5\" target=\"_blank\">\n  <picture>\n    <source media=\"(prefers-color-scheme: dark)\" srcset=\"https://static.devin.ai/assets/gh-open-in-devin-review-dark.svg?v=1\">\n    <img src=\"https://static.devin.ai/assets/gh-open-in-devin-review-light.svg?v=1\" alt=\"Open in Devin Review\">\n  </picture>\n</a>\n<!-- devin-review-badge-end -->\n\n---\n*Was this helpful? React with üëç or üëé to provide feedback.*","created_at":"2026-02-14T19:07:15Z","updated_at":"2026-02-14T19:07:15Z","html_url":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807808584","pull_request_url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5","_links":{"self":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808584"},"html":{"href":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807808584"},"pull_request":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5"}},"reactions":{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":12,"original_start_line":12,"start_side":"RIGHT","line":15,"original_line":15,"side":"RIGHT","author_association":"NONE","original_position":15,"position":15,"subject_type":"line"},{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808790","pull_request_review_id":3802345605,"id":2807808790,"node_id":"PRRC_kwDORP6kLM6nW8MW","diff_hunk":"@@ -0,0 +1,80 @@\n+import type { Card } from './schema';\n+\n+/**\n+ * Merges a local card with a remote card based on the \"offline-first\" sync strategy.\n+ *\n+ * Strategy:\n+ * - If local field is CLEAN (not in dirtyFields), accept REMOTE change.\n+ * - If local field is DIRTY (in dirtyFields), keep LOCAL change.\n+ * - If both LOCAL and REMOTE changed the same field (relative to snapshot), mark as CONFLICT.\n+ */\n+export function mergeCards(local: Card, remote: Card): Card {\n+  // Optimization: If local has no changes, we can safely overwrite with remote.\n+  if (!local.dirtyFields || local.dirtyFields.length === 0) {\n+    return remote;\n+  }\n+\n+  // We need the snapshot to determine if the remote value has changed since the last sync.\n+  const snapshot = local.syncSnapshot as Partial<Card> | undefined;\n+\n+  const result = { ...local };\n+\n+  // Fields that are synchronized and subject to merge logic.\n+  const mutableFields = [\n+    'title',\n+    'description',\n+    'status',\n+    'priority',\n+    'labels',\n+    'assignees',\n+    'position',\n+  ] as const;\n+\n+  let hasConflict = false;\n+\n+  for (const field of mutableFields) {\n+    const remoteValue = remote[field];\n+    const snapshotValue = snapshot ? snapshot[field] : undefined;\n+\n+    const isDirty = local.dirtyFields?.includes(field);\n+\n+    // Remote changed if it differs from the snapshot we took last time.\n+    // If we have no snapshot, we assume remote is different (safe default).\n+    const remoteChanged = !isEqual(remoteValue, snapshotValue);\n+\n+    if (!isDirty && remoteChanged) {\n+      // CASE: Local is clean, Remote changed.\n+      // Action: Accept GitHub value (Automation or other user).\n+      (result as any)[field] = remoteValue;","path":"packages/core/src/merge.ts","commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","original_commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","user":{"login":"devin-ai-integration[bot]","id":158243242,"node_id":"BOT_kgDOCW6Zqg","avatar_url":"https://avatars.githubusercontent.com/in/811515?v=4","gravatar_id":"","url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D","html_url":"https://github.com/apps/devin-ai-integration","followers_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/followers","following_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/repos","events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"<!-- devin-review-comment {\"id\": \"ANALYSIS-0003\", \"file_path\": \"packages/core/src/merge.ts\", \"start_line\": 20, \"end_line\": 48, \"side\": \"RIGHT\"} -->\n\nüìù **Info: Shallow copy of result means shared array references between merged card and input cards**\n\nAt line 20, `const result = { ...local }` creates a shallow copy. Array fields like `labels` and `assignees` are reference-shared with the `local` card. When the merge loop accepts a remote value at line 48 (`(result as any)[field] = remoteValue`), the result now holds a direct reference to the remote card's array. This means mutating `result.labels` later would also mutate `remote.labels`. This is standard JavaScript behavior and is fine if the codebase treats these as immutable, but it's worth being aware of ‚Äî especially since the Zod `Card` type doesn't enforce immutability and there are no `structuredClone` or spread copies made for array fields.\n\n<!-- devin-review-badge-begin -->\n<a href=\"https://app.devin.ai/review/LoFi-Monk/github-project-management/pull/5\" target=\"_blank\">\n  <picture>\n    <source media=\"(prefers-color-scheme: dark)\" srcset=\"https://static.devin.ai/assets/gh-open-in-devin-review-dark.svg?v=1\">\n    <img src=\"https://static.devin.ai/assets/gh-open-in-devin-review-light.svg?v=1\" alt=\"Open in Devin Review\">\n  </picture>\n</a>\n<!-- devin-review-badge-end -->\n\n---\n*Was this helpful? React with üëç or üëé to provide feedback.*","created_at":"2026-02-14T19:07:30Z","updated_at":"2026-02-14T19:07:31Z","html_url":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807808790","pull_request_url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5","_links":{"self":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808790"},"html":{"href":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807808790"},"pull_request":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5"}},"reactions":{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808790/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":20,"original_start_line":20,"start_side":"RIGHT","line":48,"original_line":48,"side":"RIGHT","author_association":"NONE","original_position":48,"position":48,"subject_type":"line"},{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808976","pull_request_review_id":3802345857,"id":2807808976,"node_id":"PRRC_kwDORP6kLM6nW8PQ","diff_hunk":"@@ -0,0 +1,62 @@\n+import { z } from 'zod';\n+\n+export const CardId = z.string().brand('CardId');\n+export type CardId = z.infer<typeof CardId>;\n+\n+export const ColumnId = z.union([\n+  z.literal('backlog'),\n+  z.literal('todo'),\n+  z.literal('in_progress'),\n+  z.literal('review'),\n+  z.literal('done'),\n+]);\n+export type ColumnId = z.infer<typeof ColumnId>;\n+\n+export const BoardId = z.string().brand('BoardId');\n+export type BoardId = z.infer<typeof BoardId>;\n+\n+export const Card = z.object({\n+  id: CardId,\n+  title: z.string().min(1),\n+  description: z.string().optional(),\n+  status: ColumnId,\n+  priority: z.union([\n+    z.literal('low'),\n+    z.literal('medium'),\n+    z.literal('high'),\n+    z.literal('critical'),\n+  ]),\n+  labels: z.array(z.string()),\n+  assignees: z.array(z.string()),\n+  position: z.number(),\n+  createdAt: z.string().datetime(),\n+  updatedAt: z.string().datetime(),\n+  // Sync fields\n+\n+  // Tracks which fields have been modified locally since the last sync.\n+  // Used to determine \"Local Wins\" vs \"GitHub Wins\" on a field-by-field basis.\n+  dirtyFields: z.array(z.string()).optional(),","path":"packages/core/src/schema.ts","commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","original_commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","user":{"login":"devin-ai-integration[bot]","id":158243242,"node_id":"BOT_kgDOCW6Zqg","avatar_url":"https://avatars.githubusercontent.com/in/811515?v=4","gravatar_id":"","url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D","html_url":"https://github.com/apps/devin-ai-integration","followers_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/followers","following_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/repos","events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"<!-- devin-review-comment {\"id\": \"ANALYSIS-0004\", \"file_path\": \"packages/core/src/schema.ts\", \"start_line\": 38, \"end_line\": 38, \"side\": \"RIGHT\"} -->\n\nüìù **Info: `dirtyFields` is typed as `string[]` instead of an array of known field names**\n\nThe `dirtyFields` schema at `packages/core/src/schema.ts:38` is `z.array(z.string()).optional()`, which accepts any strings. The merge algorithm at `packages/core/src/merge.ts:39` checks `local.dirtyFields?.includes(field)` where `field` comes from a hardcoded const tuple of known mutable field names. This works at runtime, but there's no schema-level validation that `dirtyFields` entries are actually valid mutable field names. A typo like `['titel']` would silently pass Zod validation but cause the merge algorithm to treat the field as clean (not dirty), potentially losing a local change. Consider using `z.array(z.enum(['title', 'description', 'status', 'priority', 'labels', 'assignees', 'position']))` to catch this class of error at validation time.\n\n<!-- devin-review-badge-begin -->\n<a href=\"https://app.devin.ai/review/LoFi-Monk/github-project-management/pull/5\" target=\"_blank\">\n  <picture>\n    <source media=\"(prefers-color-scheme: dark)\" srcset=\"https://static.devin.ai/assets/gh-open-in-devin-review-dark.svg?v=1\">\n    <img src=\"https://static.devin.ai/assets/gh-open-in-devin-review-light.svg?v=1\" alt=\"Open in Devin Review\">\n  </picture>\n</a>\n<!-- devin-review-badge-end -->\n\n---\n*Was this helpful? React with üëç or üëé to provide feedback.*","created_at":"2026-02-14T19:07:42Z","updated_at":"2026-02-14T19:07:43Z","html_url":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807808976","pull_request_url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5","_links":{"self":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808976"},"html":{"href":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807808976"},"pull_request":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5"}},"reactions":{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807808976/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":38,"original_line":38,"side":"RIGHT","author_association":"NONE","original_position":38,"position":38,"subject_type":"line"},{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807809046","pull_request_review_id":3802345941,"id":2807809046,"node_id":"PRRC_kwDORP6kLM6nW8QW","diff_hunk":"@@ -0,0 +1,62 @@\n+import { z } from 'zod';\n+\n+export const CardId = z.string().brand('CardId');\n+export type CardId = z.infer<typeof CardId>;\n+\n+export const ColumnId = z.union([\n+  z.literal('backlog'),\n+  z.literal('todo'),\n+  z.literal('in_progress'),\n+  z.literal('review'),\n+  z.literal('done'),\n+]);\n+export type ColumnId = z.infer<typeof ColumnId>;\n+\n+export const BoardId = z.string().brand('BoardId');\n+export type BoardId = z.infer<typeof BoardId>;\n+\n+export const Card = z.object({\n+  id: CardId,\n+  title: z.string().min(1),\n+  description: z.string().optional(),\n+  status: ColumnId,\n+  priority: z.union([\n+    z.literal('low'),\n+    z.literal('medium'),\n+    z.literal('high'),\n+    z.literal('critical'),\n+  ]),\n+  labels: z.array(z.string()),\n+  assignees: z.array(z.string()),\n+  position: z.number(),\n+  createdAt: z.string().datetime(),\n+  updatedAt: z.string().datetime(),\n+  // Sync fields\n+\n+  // Tracks which fields have been modified locally since the last sync.\n+  // Used to determine \"Local Wins\" vs \"GitHub Wins\" on a field-by-field basis.\n+  dirtyFields: z.array(z.string()).optional(),\n+\n+  // A copy of the card state as it was during the last successful sync.\n+  // Used to detect if the remote (GitHub) value has changed since then.\n+  syncSnapshot: z.record(z.unknown()).optional(),","path":"packages/core/src/schema.ts","commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","original_commit_id":"058c1e5b610bcb3600e357953b447e7465c32b22","user":{"login":"devin-ai-integration[bot]","id":158243242,"node_id":"BOT_kgDOCW6Zqg","avatar_url":"https://avatars.githubusercontent.com/in/811515?v=4","gravatar_id":"","url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D","html_url":"https://github.com/apps/devin-ai-integration","followers_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/followers","following_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/repos","events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/devin-ai-integration%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"body":"<!-- devin-review-comment {\"id\": \"ANALYSIS-0005\", \"file_path\": \"packages/core/src/schema.ts\", \"start_line\": 42, \"end_line\": 42, \"side\": \"RIGHT\"} -->\n\nüìù **Info: `syncSnapshot` is typed as `z.record(z.unknown())` ‚Äî loses all type safety during merge**\n\nThe `syncSnapshot` field at `packages/core/src/schema.ts:42` is `z.record(z.unknown()).optional()`, which means it's `Record<string, unknown>` at the type level. In `packages/core/src/merge.ts:18`, it's cast to `Partial<Card> | undefined` to allow field access. This cast is unchecked ‚Äî if the snapshot was constructed incorrectly (e.g., with wrong field names or wrong value types), the merge algorithm would silently use incorrect data. A stronger approach would be to define the snapshot using the same field schemas as the Card (e.g., `Card.pick({...}).partial().optional()`) so that Zod validates the snapshot's shape on parse.\n\n<!-- devin-review-badge-begin -->\n<a href=\"https://app.devin.ai/review/LoFi-Monk/github-project-management/pull/5\" target=\"_blank\">\n  <picture>\n    <source media=\"(prefers-color-scheme: dark)\" srcset=\"https://static.devin.ai/assets/gh-open-in-devin-review-dark.svg?v=1\">\n    <img src=\"https://static.devin.ai/assets/gh-open-in-devin-review-light.svg?v=1\" alt=\"Open in Devin Review\">\n  </picture>\n</a>\n<!-- devin-review-badge-end -->\n\n---\n*Was this helpful? React with üëç or üëé to provide feedback.*","created_at":"2026-02-14T19:07:51Z","updated_at":"2026-02-14T19:07:52Z","html_url":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807809046","pull_request_url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5","_links":{"self":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807809046"},"html":{"href":"https://github.com/LoFi-Monk/github-project-management/pull/5#discussion_r2807809046"},"pull_request":{"href":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/5"}},"reactions":{"url":"https://api.github.com/repos/LoFi-Monk/github-project-management/pulls/comments/2807809046/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":42,"original_line":42,"side":"RIGHT","author_association":"NONE","original_position":42,"position":42,"subject_type":"line"}]